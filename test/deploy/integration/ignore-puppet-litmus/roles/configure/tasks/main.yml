---
- name: Install and Configure Puppet Platform, Agent and PDK
  hosts: localhost
  tasks:
    - name: Download and enable Puppet platform
      ansible.builtin.include_tasks: enable-puppet/{{ ansible_os_family | lower }}.yml

- name: Install and apply module using litmus
  hosts: localhost
  tasks:
    - name: Building
      ansible.builtin.include_tasks: pdk-install-module/{{ ansible_os_family | lower }}.yml

#- name: Install puppet-install module and apply
#  hosts: localhost
#  # We would have these vars set when running with demo-deployer with <credentials>.json
##  vars:
##    nr_api_key: "{{ newrelic_personal_api_key }}"
##    nr_account_id: "{{ newrelic_account_id }}"
##    nr_region: "{{ newrelic_region|upper }}"
#  vars:
#    nr_api_key: "YOUR-API-KEY"
#    nr_account_id: 11274407 #your account id
#    nr_region: "STAGING"
#

- name: Try running litmus test...
  hosts: localhost
  tasks:
    - name: Run litmus test for infra?
      ansible.builtin.include_tasks: pdk-litmus-run-test/{{ ansible_os_family | lower }}.yml
